{
  "type": "CityJSONExtension",
  "name": "dynamizer",
  "description": "Extension to model dynamic attributes",
  "uri": "https://github.com/1khawla/CityJSON-Dynamizer/blob/main/dynamizer.ext.json",
  "version": "1.0",
  "versionCityJSON": "1.1",
  "definitions": {
    "SensorConnection": {
      "properties": {
        "SensorId": {
          "type": "string"
        },
        "serviceType": {
          "type": "string"
        },
        "linkToObservation": {
          "description": "link to observation response",
          "uri": {
            "type": "string"
          }  
        },
        "linkToSensor": {
          "description": "link to the description/metadata of the sensor device",
          "uri": {
            "type": "string"
          }  
        },
        "sensorLocation": {
          "$ref": "cityobjects.schema.json#/_AbstractCityObject"
        }
      }
    },
    "dynamicData-DR": {
      "time": {
        "type": "string"
      },
      "value": {
        "type": "number"
      }
    },
    "dynamicData-TVP": {
      "time": {
        "type": "string"
      },
      "value": {
        "type": "number"
      }
    },
    "observationData": {
      "time": {
        "type": "string"
      },
      "value": {
        "type": "number"
      }
    },
    "AtomicTimeseries": {
      "oneOf": [
        {
          "$ref": "#/definitions/dynamicData-DR"
        },
        {
          "$ref": "#/definitions/dynamicData-TVP"
        },
        {
          "$ref": "#/definitions/observationData"
        }
      ]
    },
    "CompositeTimeseries": {
      "properties": {
        "BaseTime": {
          "type": "string"
        },
        "spacing": {
          "type": "string"
        },
        "timeseriesComponent": {
          "repetitions": {
            "type": "number"
          },
          "AdditionalGap": {
            "type": "string"
          },
          "type": "array",
          "value": {
            "$ref": "#/definitions/AtomicTimeseries"
          }
        }
      }
    },
    "_AbstractTimeseries": {
      "type": "object",
      "properties": {
        "timeseries": {
          "description": "It contains dynamic data to model",
          "type": "number",
          "subclass": {
            "oneOf": [
              {
                "$ref": "#/definitions/AtomicTimeseries"
              },
              {
                "$ref": "#/definitions/CompositeTimeseries"
              }
            ]
          },
          "linkToObservation": {
            "$ref": "#/definitions/SensorConnection"
          }
        }
      }
    }
  },
  "extraRootProperties": {},
  "extraAttributes": {
    "_AbstractCityObject": {
      "+dynamizer": {
        "type": "object",
        "properties": {
          "attributeRef": {
            "description": "It refers to a specific attribute of a specific city object by using an uri expression. This is the static property that should be overridden by timeseries data",
            "uri": {
              "type": "string"
            }  
          },
          "startTime": {
            "type": "string"
          },
          "endTime": {
            "type": "string"
          },
          "linkToSensor": {
            "$ref": "#/definitions/SensorConnection"
          },
          "dynamicData": {
            "$ref": "#/definitions/_AbstractTimeSeries"
          }
        }
      }
    }
  },
  "extraCityObjects": {}
}
